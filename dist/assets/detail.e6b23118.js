var W=Object.defineProperty,q=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var P=(r,u,i)=>u in r?W(r,u,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[u]=i,F=(r,u)=>{for(var i in u||(u={}))O.call(u,i)&&P(r,i,u[i]);if(z)for(var i of z(u))X.call(u,i)&&P(r,i,u[i]);return r},U=(r,u)=>q(r,J(u));import{h as B,j as T,u as E,i as n,x as w,V as R,o as m,k as f,y as l,z as N,p as c,m as D,J as Y,n as Z,t as b,B as G,F as S,l as I,W as K,w as $,X as M,N as L,Y as Q,G as ee,H as ae,v as te,c as se,Z as le,_ as H,$ as oe}from"./vendor.97637db4.js";import{_ as V,a as A}from"./index.0117ab02.js";const ne={class:"songCpt"},ce={class:"song-img-warp"},ue={class:"song-img"},ie={class:"song-introduce"},re={class:"song-name"},de={key:0},_e={class:"lyric"},pe=B({emits:["get-data"],setup(r,{emit:u}){const i=T(),_=E(),p=i.params.id;let y=n(""),v=n({}),d=[],h=n("");const g=()=>{k()},k=async()=>{const e=(await A.get({url:"/song/detail",data:{ids:p}})).songs[0];v.value={name:e.name,ar:e.ar,al:e.al,alName:e.al.name},_.commit("update",{key:"songDetail",value:e}),u("get-data",e),y.value=e.al.picUrl};w(()=>_.state.lyric,s=>{d=s.lyricData,h.value=s.lyricData[0].lyric}),w(()=>_.state.playTime,s=>{if(d.length>0){const e=s.toFixed(2),a=d.find(o=>{if(Number(e)<Number(o.s))return o});try{h.value=a.lyric}catch{h.value=""}}});const t=R(()=>(console.log("playState",_.state.palyState),_.state.palyState));return g(),(s,e)=>(m(),f("div",ne,[l("div",{class:N(["song-switch-img",{playClass:c(t)}])},null,2),l("div",ce,[l("div",{class:N(["song-img-content",{playClass:c(t)}])},[l("div",ue,[D(c(Y),{width:"180",height:"180",src:c(y),round:""},null,8,["src"])])],2)]),l("div",ie,[l("h4",re,[Z(b(c(v).name)+" ",1),c(v).alName?(m(),f("span",de,"("+b(c(v).alName)+")",1)):G("",!0)]),l("p",null,[(m(!0),f(S,null,I(c(v).ar,(a,o)=>(m(),f("span",{key:a.id},b(a.name)+" "+b(o!==c(v).ar.length-1?"/":""),1))),128))]),l("p",_e,b(c(h)),1)])]))}});var ve=V(pe,[["__scopeId","data-v-1435f370"]]);const me={class:"lyric-content"},ye={class:"lyric-title"},ge={class:"creation"},fe=B({emits:["lyric-callback"],setup(r,{emit:u}){const _=T().params.id,p=n({}),y=E(),v=n([]),d=n({}),h=n(null);w(()=>y.state.songDetail,t=>{p.value=F(F({},p.value),t),console.log(p.value)}),(async()=>{const t=await A.get({url:"/lyric",data:{id:_}});let s=[];t.lrc.lyric.split(`
`).forEach((e,a)=>{if(e.length<1)return!1;const o=e.match(/[\[\0-9:0-9.0-9\]]+/)[0],C=o.replace(/(\[|\])+/g,""),x=e.replace(o,""),j=(C.split(":")[0]*60+C.split(":")[1]*1).toFixed(2);s.push({i:a,s:j,lyric:x})}),t.lyricData=s,v.value=s,u("lyric-callback",t),y.commit("update",{key:"lyric",value:t})})(),w(()=>y.state.playTime,t=>{if(v.value.length>0){const s=t.toFixed(2),e=v.value.find(a=>{if(Number(s)<Number(a.s))return a});try{d.value.s!==e.s&&(d.value={s:e.s,i:e.i})}catch{}}});const k=R(()=>{const t=document.querySelectorAll(".lyricDetail li")[d.value.i];if(t){const s=t.offsetParent;h.value.scrollTop=t.offsetTop-s.offsetHeight/2}return d.value.s});return(t,s)=>(m(),f("div",me,[l("div",ye,[l("h4",null,b(p.value.name),1),l("h5",ge,[(m(!0),f(S,null,I(p.value.ar,e=>(m(),f("span",{key:e.id},b(e.name),1))),128))])]),l("div",{class:"lyricDetail",ref:(e,a)=>{a.lyricDetailDom=e,h.value=e}},[l("ul",null,[(m(!0),f(S,null,I(v.value,e=>(m(),f("li",{class:N({cur:e.s===c(k)}),key:e.s},b(e.lyric),3))),128))])],512)]))}});var he=V(fe,[["__scopeId","data-v-cfc708bc"]]);const De=r=>(ee("data-v-6f4c14d3"),r=r(),ae(),r),be={class:"play-control"},ke={class:"paly-slider"},Ce=De(()=>l("div",{class:"custom-button"},null,-1)),xe={class:"control"},Be=["src"],Se=B({emits:["player-callback"],setup(r,{emit:u}){const i=n(!1),_=n("play-circle-o"),p=n(0),y=E(),d=T().params.id;let h=n(""),g=n(null);n(null);let k=n(0);const t=o=>{const x=o/100*k.value;g.value.currentTime=x},s=async()=>{const{data:o}=await A.get({url:"/song/url",data:{id:d}});h.value=o[0].url,u("player-callback")};K(()=>{}),s();const e=o=>{const C=g.value.currentTime;p.value=C/k.value*100,y.commit("update",{key:"playTime",value:C})},a=()=>{i.value=!i.value,i.value?(g.value.play(),_.value="pause-circle-o"):(g.value.pause(),_.value="play-circle-o"),y.commit("update",{key:"palyState",value:i.value}),k.value=g.value.duration};return(o,C)=>(m(),f("div",be,[l("div",ke,[D(c(M),{modelValue:p.value,"onUpdate:modelValue":C[0]||(C[0]=x=>p.value=x),"active-color":"#ee0a24",onChange:t},{button:$(()=>[Ce]),_:1},8,["modelValue"])]),l("div",xe,[D(c(L),{name:""}),l("div",{class:"playBtn",onClick:a},[D(c(L),{name:_.value},null,8,["name"])])]),l("audio",{id:"songAudio",ref:(x,j)=>{j.audioDom=x,Q(g)?g.value=x:g=x},src:c(h),onTimeupdate:e},null,40,Be)]))}});var $e=V(Se,[["__scopeId","data-v-6f4c14d3"]]);const Fe={class:"songWarp"},Te={class:"song-header"},we=B({name:"songDetail"});function Ne(r){const u=T(),i=te();u.params.id;const _=n("song"),p=n(null);n("");const y=n(!0),v=n(null);n({});const d=n(["\u514D\u8D39\u7684\u670D\u52A1\u5668,\u7B49\u7B49\u5427...\u{1F600}"]),h=s=>{const e=p.value;e.style.background=`url(${s.al.picUrl}),linear-gradient(138deg, #ee9ae5, #5961f9) `,e.style.backgroundSize="100% 100%",d.value.push("\u97F3\u4E50\u8BE6\u60C5\u5B8C\u6BD5\u270C"),t()},g=s=>{d.value.push("\u97F3\u4E50\u5730\u5740\u68C0\u6D4B\u5B8C\u6BD5\u{1F44F}"),t()},k=s=>{d.value.push("\u97F3\u4E50\u6B4C\u8BCD\u52A0\u8F7D\u597D\u5566\u{1F60E}"),t()},t=()=>{d.value.length===4&&(d.value.push("\u5B8C\u6BD5\u{1F601}"),setTimeout(function(){y.value=!1},100))};return(s,e)=>(m(),f(S,null,[y.value?(m(),se(c(le),{key:0,class:"loadingAll",size:"24px",vertical:""},{default:$(()=>[(m(!0),f(S,null,I(d.value,(a,o)=>(m(),f("p",{key:o},b(o+1)+" "+b(a),1))),128))]),_:1})):G("",!0),l("div",{id:"songDetail",class:N({mohu:y.value})},[l("div",{ref:(a,o)=>{o.imgbjDom=a,p.value=a},class:"imgbj"},null,512),l("div",Fe,[l("div",Te,[D(c(L),{name:"arrow-down",onClick:e[0]||(e[0]=a=>c(i).back())}),D(c(oe),{ref:(a,o)=>{o.tabs=a,v.value=a},active:_.value,"onUpdate:active":e[1]||(e[1]=a=>_.value=a),swipeable:""},{default:$(()=>[D(c(H),{title:"\u6B4C\u66F2",name:"song"},{default:$(()=>[D(ve,{onGetData:h})]),_:1}),D(c(H),{title:"\u6B4C\u8BCD",name:"lyric"},{default:$(()=>[D(he,{onLyricCallback:k})]),_:1})]),_:1},8,["active"])]),D($e,{onPlayerCallback:g})])],2)],64))}const Ie=B(U(F({},we),{setup:Ne}));var Le=V(Ie,[["__scopeId","data-v-de7f9ebe"]]);export{Le as default};
