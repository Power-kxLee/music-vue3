import{_ as J,a as j}from"./index.0117ab02.js";import{h as M,j as $,v as K,i as c,x as W,P as X,E as Y,o as u,k as p,y as e,m as l,p as t,Q as Z,w as b,I as U,J as F,t as i,R as H,N as x,B,G as ee,H as te,c as ae,F as se,l as oe,U as ne}from"./vendor.97637db4.js";const le=g=>(ee("data-v-761f12bc"),g=g(),te(),g),ie={class:"songDetail"},ce={class:"header"},re={class:"main"},de={class:"main-header"},ue={key:0},_e={class:"playListHeader"},pe={class:"coverImg"},he={class:"pl-right"},ve={class:"creator"},ge={class:"creatorImg"},me={class:"creatorName"},fe={class:"description"},ye=le(()=>e("span",{class:"description-name"},"\u7B80\u4ECB:",-1)),ke={class:"header-util"},Ce={class:"main-list"},xe={class:"song-content"},Be={class:"song-list"},Ie=["onClick"],we={class:"song-index"},Ee={class:"song-item-right"},be={class:"song-name"},Le={key:0},De={class:"singer"},Ne={key:0,class:"sq-icon"},Se=M({setup(g){const I=$(),L=K();let D={coverImgUrl:"",name:"",description:"",playCount:0,shareCount:"",commentCount:"",creator:{backgroundUrl:"",nickname:""}},n=c(D),m={id:""},_=c(!0),N=c(!0),f=c([]),y=c("\u6B4C\u5355"),k=c({});const R=async a=>{const o=await j.get({url:"/playlist/detail",data:{id:a}}),{playlist:s}=o,{coverImgUrl:r,name:d,creator:v,description:E,playCount:Q,commentCount:z,shareCount:G}=s;return n.value={coverImgUrl:r,commentCount:z,name:d,creator:v,description:E,shareCount:G,playCount:Q},_.value=!1,s},T=async a=>a.length<1?void 0:await j.get({url:"/song/detail",data:{ids:a}}),V=a=>{let o=[];return a.forEach(s=>{o.push(s.id)}),o.join(",")},A=(a,o)=>{let s=0,r=0,d=[],v={};return a.forEach(E=>{s++,d.push(E),s===o&&(s=0,v[r]=d,r++,d=[])}),v[r]=d,v},S=async a=>{const o=await R(a);k.value=A(o.trackIds,20)},C=c(!1),w=c(!1);let h=0;const O=async()=>{const a=Object.keys(k.value).length,o=V(k.value[h]),{songs:s}=await T(o);f.value=[...f.value,...s],C.value=!1,console.log(h),h++,h===a-1&&(w.value=!0)},q=()=>{_.value=!0,N.value=!0,n.value=D,f.value=[],C.value=!0,w.value=!1,h=0,y.value="\u6B4C\u5355"};W(()=>I.params,(a,o)=>{if(!(I.path.indexOf("/playlist/detail/")<0)){if((m==null?void 0:m.id)===(a==null?void 0:a.id)){_.value=!1,N.value=!1;return}q(),S(a.id)}}),X((a,o)=>{m=o.params}),Y(()=>{const a=document.querySelector(".main");console.log(a.scrollTop),a.addEventListener("scroll",()=>{const o=a.scrollTop;console.log(a.scrollTop),o>=120?y.value=n.value.name:y.value="\u6B4C\u5355"})}),S(I.params.id);const P=()=>{L.back()};return(a,o)=>(u(),p("div",ie,[e("div",ce,[l(t(Z),{"left-arrow":"",onClickLeft:P},{title:b(()=>[l(t(H),{text:t(y)},null,8,["text"])]),_:1})]),e("div",re,[e("div",de,[l(t(U),{title:"",avatar:"","avatar-size":"100px",row:4,loading:t(_)},null,8,["loading"]),t(_)?B("",!0):(u(),p("div",ue,[e("div",_e,[e("div",pe,[l(t(F),{width:"100%",height:"100%",src:t(n).coverImgUrl},null,8,["src"])]),e("div",he,[e("h1",null,i(t(n).name),1),e("div",ve,[e("div",ge,[l(t(F),{width:"100%",height:"100%",src:t(n).creator.backgroundUrl},null,8,["src"])]),e("span",me,i(t(n).creator.nickname),1)]),e("div",fe,[ye,l(t(H),{text:t(n).description},null,8,["text"]),l(t(x),{name:"arrow"})])])]),e("div",ke,[e("div",null,[l(t(x),{name:"like-o"}),e("span",null,i(t(n).playCount/1e4^0)+"\u4E07",1)]),e("div",null,[l(t(x),{name:"smile-comment-o"}),e("span",null,i(t(n).commentCount),1)]),e("div",null,[l(t(x),{name:"guide-o"}),e("span",null,"\u5206\u4EAB"+i(t(n).shareCount),1)])])]))]),e("div",Ce,[l(t(U),{title:"",row:20,loading:t(_)},{default:b(()=>[Object.keys(t(k)).length>0?(u(),ae(t(ne),{key:0,loading:C.value,"onUpdate:loading":o[0]||(o[0]=s=>C.value=s),"loading-text":"\u97F3\u4E50\u5728\u8DEF\u4E0A(Vercel\u90E8\u7F72\u7684\u670D\u52A1\u5668 \u5C06\u5C31\u4E0B\u54C8)",finished:w.value,onLoad:O},{default:b(()=>[e("div",xe,[e("ul",Be,[(u(!0),p(se,null,oe(t(f),(s,r)=>(u(),p("li",{class:"song-item",key:s.id,onClick:d=>t(L).push("/song/detail/"+s.id)},[e("b",we,i(Number(r)+1),1),e("div",Ee,[e("h4",be,[e("span",null,i(s.name),1),s.alia[0]?(u(),p("span",Le,"("+i(s.alia[0])+")",1)):B("",!0)]),e("p",De,[[1,2].includes(s.no)?(u(),p("span",Ne,"SQ")):B("",!0),e("span",null,i(s.ar[0].name)+" - "+i(s.al.name),1)])])],8,Ie))),128))])])]),_:1},8,["loading","finished"])):B("",!0)]),_:1},8,["loading"])])])]))}});var Fe=J(Se,[["__scopeId","data-v-761f12bc"]]);export{Fe as default};
